  [1m[35m (1.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
Started POST "/message" for 127.0.0.1 at 2020-12-19 18:23:41 +0400
Processing by MessagesController#create as HTML
  Parameters: {"author"=>"Ruby", "message"=>"Hello World"}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.7ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 14:23:41.408618"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 3.7ms)
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
Started POST "/message" for 127.0.0.1 at 2020-12-19 18:23:41 +0400
Processing by MessagesController#create as HTML
  Parameters: {"author"=>"", "message"=>""}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 14:23:41.419462"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/message/2/like" for 127.0.0.1 at 2020-12-19 18:23:41 +0400
Processing by MessagesController#like as HTML
  Parameters: {"message_id"=>"2", "message"=>{}}
Unpermitted parameter: :message
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mLike Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "likes" WHERE "likes"."message_id" = $1 AND "likes"."ip_address" = $2 LIMIT $3[0m  [["message_id", 2], ["ip_address", "127.0.0.1"], ["LIMIT", 1]]
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mLike Create (0.4ms)[0m  [1m[32mINSERT INTO "likes" ("ip_address", "message_id", "created_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["ip_address", "127.0.0.1"], ["message_id", 2], ["created_at", "2020-12-19 14:23:41.436412"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 17ms (Views: 0.2ms | ActiveRecord: 3.8ms)
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 14:23:41.441131"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/message/4/like" for 127.0.0.1 at 2020-12-19 18:23:41 +0400
Processing by MessagesController#like as HTML
  Parameters: {"message_id"=>"4", "message"=>{}}
Unpermitted parameter: :message
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mLike Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "likes" WHERE "likes"."message_id" = $1 AND "likes"."ip_address" = $2 LIMIT $3[0m  [["message_id", 4], ["ip_address", "127.0.0.1"], ["LIMIT", 1]]
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.6ms)
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
Started POST "/message" for 127.0.0.1 at 2020-12-19 18:25:02 +0400
Processing by MessagesController#create as HTML
  Parameters: {"author"=>"Ruby", "message"=>"Hello World"}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.4ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 14:25:02.416384"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 3.3ms)
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
Started POST "/message" for 127.0.0.1 at 2020-12-19 18:25:02 +0400
Processing by MessagesController#create as HTML
  Parameters: {"author"=>nil, "message"=>nil}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 14:25:02.427059"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/message/5/like" for 127.0.0.1 at 2020-12-19 18:25:02 +0400
Processing by MessagesController#like as HTML
  Parameters: {"message_id"=>"5", "message"=>{}}
Unpermitted parameter: :message
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mLike Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "likes" WHERE "likes"."message_id" = $1 AND "likes"."ip_address" = $2 LIMIT $3[0m  [["message_id", 5], ["ip_address", "127.0.0.1"], ["LIMIT", 1]]
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mLike Create (0.3ms)[0m  [1m[32mINSERT INTO "likes" ("ip_address", "message_id", "created_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["ip_address", "127.0.0.1"], ["message_id", 5], ["created_at", "2020-12-19 14:25:02.443599"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 16ms (Views: 0.2ms | ActiveRecord: 3.2ms)
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 14:25:02.447281"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/message/7/like" for 127.0.0.1 at 2020-12-19 18:25:02 +0400
Processing by MessagesController#like as HTML
  Parameters: {"message_id"=>"7", "message"=>{}}
Unpermitted parameter: :message
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mLike Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "likes" WHERE "likes"."message_id" = $1 AND "likes"."ip_address" = $2 LIMIT $3[0m  [["message_id", 7], ["ip_address", "127.0.0.1"], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
Started POST "/message" for 127.0.0.1 at 2020-12-19 18:27:18 +0400
Processing by MessagesController#create as HTML
  Parameters: {"author"=>"Ruby", "message"=>"Hello World"}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.3ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 14:27:18.897687"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 3.3ms)
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
Started POST "/message" for 127.0.0.1 at 2020-12-19 18:27:18 +0400
Processing by MessagesController#create as HTML
  Parameters: {"author"=>nil, "message"=>nil}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 4ms (Views: 0.1ms | ActiveRecord: 0.3ms)
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 14:27:18.909737"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/message/8/like" for 127.0.0.1 at 2020-12-19 18:27:18 +0400
Processing by MessagesController#like as HTML
  Parameters: {"message_id"=>"8", "message"=>{}}
Unpermitted parameter: :message
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mLike Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "likes" WHERE "likes"."message_id" = $1 AND "likes"."ip_address" = $2 LIMIT $3[0m  [["message_id", 8], ["ip_address", "127.0.0.1"], ["LIMIT", 1]]
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  [1m[36mLike Create (0.3ms)[0m  [1m[32mINSERT INTO "likes" ("ip_address", "message_id", "created_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["ip_address", "127.0.0.1"], ["message_id", 8], ["created_at", "2020-12-19 14:27:18.925988"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 16ms (Views: 0.1ms | ActiveRecord: 3.5ms)
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 14:27:18.929935"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/message/10/like" for 127.0.0.1 at 2020-12-19 18:27:18 +0400
Processing by MessagesController#like as HTML
  Parameters: {"message_id"=>"10", "message"=>{}}
Unpermitted parameter: :message
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mLike Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "likes" WHERE "likes"."message_id" = $1 AND "likes"."ip_address" = $2 LIMIT $3[0m  [["message_id", 10], ["ip_address", "127.0.0.1"], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 3ms (Views: 0.1ms | ActiveRecord: 0.6ms)
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(2354612789639215980)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddLockVersionToMessage (20201219153644)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "messages" ADD "lock_version" integer[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20201219153644"]]
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2020-12-19 16:25:32.896048"], ["key", "environment"]]
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(2354612789639215980)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
Started POST "/message" for 127.0.0.1 at 2020-12-19 20:28:57 +0400
Processing by MessagesController#create as HTML
  Parameters: {"author"=>"Ruby", "message"=>"Hello World"}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.4ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 16:28:57.694822"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 3.4ms)
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
Started POST "/message" for 127.0.0.1 at 2020-12-19 20:28:57 +0400
Processing by MessagesController#create as HTML
  Parameters: {"author"=>nil, "message"=>nil}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 4ms (Views: 0.1ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 16:28:57.706809"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/message/11/like" for 127.0.0.1 at 2020-12-19 20:28:57 +0400
Processing by MessagesController#like as HTML
  Parameters: {"message_id"=>"11", "message"=>{}}
Unpermitted parameter: :message
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mLike Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "likes" WHERE "likes"."message_id" = $1 AND "likes"."ip_address" = $2 LIMIT $3[0m  [["message_id", 11], ["ip_address", "127.0.0.1"], ["LIMIT", 1]]
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  [1m[36mLike Create (0.3ms)[0m  [1m[32mINSERT INTO "likes" ("ip_address", "message_id", "created_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["ip_address", "127.0.0.1"], ["message_id", 11], ["created_at", "2020-12-19 16:28:57.723442"]]
  [1m[36mMessage Update (0.2ms)[0m  [1m[33mUPDATE "messages" SET "likes" = $1, "lock_version" = $2 WHERE "messages"."id" = $3 AND "messages"."lock_version" = $4[0m  [["likes", 1], ["lock_version", 1], ["id", 11], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 17ms (Views: 0.1ms | ActiveRecord: 3.6ms)
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 16:28:57.727850"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/message/13/like" for 127.0.0.1 at 2020-12-19 20:28:57 +0400
Processing by MessagesController#like as HTML
  Parameters: {"message_id"=>"13", "message"=>{}}
Unpermitted parameter: :message
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.3ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 16:28:57.731881"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/top_messages/week" for 127.0.0.1 at 2020-12-19 20:28:57 +0400
Processing by MessagesController#top_messages as HTML
  Parameters: {"period"=>"week", "message"=>{}}
Unpermitted parameter: :message
  [1m[36mMessage Load (0.8ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE (created_at > '2020-12-18 20:00:00') ORDER BY "messages"."likes" ASC LIMIT $1[0m  [["LIMIT", 5]]
Completed 200 OK in 2ms (Views: 0.6ms | ActiveRecord: 0.8ms)
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
Started POST "/message" for 127.0.0.1 at 2020-12-19 20:47:24 +0400
Processing by MessagesController#create as HTML
  Parameters: {"author"=>"Ruby", "message"=>"Hello World"}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.4ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 16:47:24.918750"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 21ms (Views: 0.2ms | ActiveRecord: 5.8ms)
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
Started POST "/message" for 127.0.0.1 at 2020-12-19 20:47:24 +0400
Processing by MessagesController#create as HTML
  Parameters: {"author"=>nil, "message"=>nil}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 570ms (Views: 0.1ms | ActiveRecord: 0.3ms)
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 16:47:25.496478"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/message/15/like" for 127.0.0.1 at 2020-12-19 20:47:25 +0400
Processing by MessagesController#like as HTML
  Parameters: {"message_id"=>"15", "message"=>{}}
Unpermitted parameter: :message
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mLike Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "likes" WHERE "likes"."message_id" = $1 AND "likes"."ip_address" = $2 LIMIT $3[0m  [["message_id", 15], ["ip_address", "127.0.0.1"], ["LIMIT", 1]]
  [1m[36mMessage Load (0.3ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mLike Create (0.3ms)[0m  [1m[32mINSERT INTO "likes" ("ip_address", "message_id", "created_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["ip_address", "127.0.0.1"], ["message_id", 15], ["created_at", "2020-12-19 16:47:25.511210"]]
  [1m[36mMessage Update (0.2ms)[0m  [1m[33mUPDATE "messages" SET "likes" = $1, "lock_version" = $2 WHERE "messages"."id" = $3 AND "messages"."lock_version" = $4[0m  [["likes", 1], ["lock_version", 1], ["id", 15], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 15ms (Views: 0.2ms | ActiveRecord: 3.9ms)
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 16:47:25.515795"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/message/17/like" for 127.0.0.1 at 2020-12-19 20:47:25 +0400
Processing by MessagesController#like as HTML
  Parameters: {"message_id"=>"17", "message"=>{}}
Unpermitted parameter: :message
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.1ms)
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 16:47:25.519556"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/top_messages/week" for 127.0.0.1 at 2020-12-19 20:47:25 +0400
Processing by MessagesController#top_messages as HTML
  Parameters: {"period"=>"week", "message"=>{}}
Unpermitted parameter: :message
  [1m[36mMessage Load (0.3ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE (created_at > '2020-12-18 20:00:00') ORDER BY "messages"."likes" ASC LIMIT $1[0m  [["LIMIT", 5]]
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Marlon"], ["message", "I love you."], ["created_at", "2020-12-19 16:47:25.524685"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mLike Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "likes" WHERE "likes"."message_id" = $1 AND "likes"."ip_address" = $2 LIMIT $3[0m  [["message_id", 18], ["ip_address", "157.209.241.106"], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
  [1m[36mLike Create (0.2ms)[0m  [1m[32mINSERT INTO "likes" ("ip_address", "message_id", "created_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["ip_address", "157.209.241.106"], ["message_id", 18], ["created_at", "2020-12-19 16:47:25.526693"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "likes"[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Antwan"], ["message", "I love you too, honey. Good luck with your show."], ["created_at", "2020-12-19 16:47:25.530281"], ["lock_version", 0]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mLike Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "likes" WHERE "likes"."message_id" = $1 AND "likes"."ip_address" IS NULL LIMIT $2[0m  [["message_id", 19], ["LIMIT", 1]]
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 19], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "likes"[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Kandra"], ["message", "Happy."], ["created_at", "2020-12-19 16:47:25.536397"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mLike Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "likes" WHERE "likes"."message_id" = $1 AND "likes"."ip_address" = $2 LIMIT $3[0m  [["message_id", 20], ["ip_address", "InvalidIP"], ["LIMIT", 1]]
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 20], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "likes"[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Donte"], ["message", "Am I dying, or is this my birthday?"], ["created_at", "2020-12-19 16:47:25.540476"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mLike Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM "likes" WHERE "likes"."message_id" = $1 AND "likes"."ip_address" = $2 LIMIT $3[0m  [["message_id", 873], ["ip_address", "136.19.196.198"], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 873], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "likes"[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Zora"], ["message", "Well, this is certainly a pleasant surprise."], ["created_at", "2020-12-19 16:47:25.544348"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "messages"[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "messages"[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "messages"[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "messages"[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "messages"[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
Started POST "/message" for 127.0.0.1 at 2020-12-19 20:48:13 +0400
Processing by MessagesController#create as HTML
  Parameters: {"author"=>"Ruby", "message"=>"Hello World"}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.4ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 16:48:13.642983"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 3.4ms)
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
Started POST "/message" for 127.0.0.1 at 2020-12-19 20:48:13 +0400
Processing by MessagesController#create as HTML
  Parameters: {"author"=>nil, "message"=>nil}
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 580ms (Views: 0.1ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 16:48:14.230869"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/message/24/like" for 127.0.0.1 at 2020-12-19 20:48:14 +0400
Processing by MessagesController#like as HTML
  Parameters: {"message_id"=>"24", "message"=>{}}
Unpermitted parameter: :message
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 24], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mLike Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "likes" WHERE "likes"."message_id" = $1 AND "likes"."ip_address" = $2 LIMIT $3[0m  [["message_id", 24], ["ip_address", "127.0.0.1"], ["LIMIT", 1]]
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 24], ["LIMIT", 1]]
  [1m[36mLike Create (0.3ms)[0m  [1m[32mINSERT INTO "likes" ("ip_address", "message_id", "created_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["ip_address", "127.0.0.1"], ["message_id", 24], ["created_at", "2020-12-19 16:48:14.245426"]]
  [1m[36mMessage Update (0.2ms)[0m  [1m[33mUPDATE "messages" SET "likes" = $1, "lock_version" = $2 WHERE "messages"."id" = $3 AND "messages"."lock_version" = $4[0m  [["likes", 1], ["lock_version", 1], ["id", 24], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 15ms (Views: 0.1ms | ActiveRecord: 3.7ms)
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 16:48:14.249839"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/message/26/like" for 127.0.0.1 at 2020-12-19 20:48:14 +0400
Processing by MessagesController#like as HTML
  Parameters: {"message_id"=>"26", "message"=>{}}
Unpermitted parameter: :message
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.2ms)
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Ruby"], ["message", "Hello World"], ["created_at", "2020-12-19 16:48:14.254166"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/top_messages/week" for 127.0.0.1 at 2020-12-19 20:48:14 +0400
Processing by MessagesController#top_messages as HTML
  Parameters: {"period"=>"week", "message"=>{}}
Unpermitted parameter: :message
  [1m[36mMessage Load (0.3ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE (created_at > '2020-12-18 20:00:00') ORDER BY "messages"."likes" ASC LIMIT $1[0m  [["LIMIT", 5]]
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Queenie"], ["message", "One! Two! Three!"], ["created_at", "2020-12-19 16:48:14.259706"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mLike Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "likes" WHERE "likes"."message_id" = $1 AND "likes"."ip_address" = $2 LIMIT $3[0m  [["message_id", 27], ["ip_address", "39.189.106.158"], ["LIMIT", 1]]
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 27], ["LIMIT", 1]]
  [1m[36mLike Create (0.2ms)[0m  [1m[32mINSERT INTO "likes" ("ip_address", "message_id", "created_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["ip_address", "39.189.106.158"], ["message_id", 27], ["created_at", "2020-12-19 16:48:14.262266"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "likes"[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Laverne"], ["message", "Do you want me to come with you?"], ["created_at", "2020-12-19 16:48:14.265714"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mLike Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "likes" WHERE "likes"."message_id" = $1 AND "likes"."ip_address" IS NULL LIMIT $2[0m  [["message_id", 28], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 28], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "likes"[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Terresa"], ["message", "I forgot something."], ["created_at", "2020-12-19 16:48:14.270161"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mLike Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "likes" WHERE "likes"."message_id" = $1 AND "likes"."ip_address" = $2 LIMIT $3[0m  [["message_id", 29], ["ip_address", "InvalidIP"], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 29], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "likes"[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Harris"], ["message", "No comment."], ["created_at", "2020-12-19 16:48:14.273932"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mLike Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "likes" WHERE "likes"."message_id" = $1 AND "likes"."ip_address" = $2 LIMIT $3[0m  [["message_id", 355], ["ip_address", "201.255.20.20"], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = $1 LIMIT $2[0m  [["id", 355], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "likes"[0m
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mMessage Create (0.3ms)[0m  [1m[32mINSERT INTO "messages" ("author", "message", "created_at", "lock_version") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["author", "Robby"], ["message", "Does nobody understand?"], ["created_at", "2020-12-19 16:48:14.278833"], ["lock_version", 0]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "messages"[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "messages"[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "messages"[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "messages"[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "messages"[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
